\hypertarget{group__uart}{\section{U\-A\-R\-T Library}
\label{group__uart}\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}}
}


U\-A\-R\-T Library enabling you to control all available U\-A\-R\-T Modules.  


\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{serial_8c}{serial.\-c}
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Library Implementation. \end{DoxyCompactList}\item 
file \hyperlink{serial_8h}{serial.\-h}
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Library Header File. \end{DoxyCompactList}\item 
file \hyperlink{serial__device_8h}{serial\-\_\-device.\-h}
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Library device-\/specific configuration. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}~32
\begin{DoxyCompactList}\small\item\em If you define this, a '\textbackslash{}r' (C\-R) will be put in front of a '\textbackslash{}n' (L\-F) when sending a byte. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}~16
\begin{DoxyCompactList}\small\item\em T\-X Buffer Size in Bytes (Power of 2) \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gaff1f07741fbe1f53f46098687f0a05e2}{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}
\begin{DoxyCompactList}\small\item\em Defining this enables incoming X\-O\-N X\-O\-F\-F (sends X\-O\-F\-F if rx buff is full) \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}{F\-L\-O\-W\-M\-A\-R\-K}~5
\begin{DoxyCompactList}\small\item\em Space remaining to trigger xoff/xon. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{X\-O\-N}~0x11
\begin{DoxyCompactList}\small\item\em X\-O\-N Value. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}{X\-O\-F\-F}~0x13
\begin{DoxyCompactList}\small\item\em X\-O\-F\-F Value. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gafccfd7d1315f0763ac404c6104883341}{B\-A\-U\-D}(baud\-Rate, xtal\-Cpu)~((xtal\-Cpu)/((baud\-Rate)$\ast$16l)-\/1)
\begin{DoxyCompactList}\small\item\em Calculate Baudrate Register Value. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\-\_\-t \hyperlink{group__uart_ga1ea963b291215ad9c5e8a0610f116b90}{serial\-Available} (void)
\begin{DoxyCompactList}\small\item\em Get number of available U\-A\-R\-T modules. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_ga73d4335cb201753c580c87954f493886}{serial\-Init} (uint8\-\_\-t uart, uint16\-\_\-t baud)
\begin{DoxyCompactList}\small\item\em Initialize the U\-A\-R\-T Hardware. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_gaa16a5ecaf9e40660ded50737ff1d0a88}{serial\-Close} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Stop the U\-A\-R\-T Hardware. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_ga5d5de9e3ed5a0be11f707113cfff33f5}{set\-Flow} (uint8\-\_\-t uart, uint8\-\_\-t on)
\begin{DoxyCompactList}\small\item\em Manually change the flow control. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}{serial\-Has\-Char} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if a byte was received. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_gaf7c4238a9a5e8fff64af1faf1689a5a4}{serial\-Get\-Blocking} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Wait until a character is received. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_gaa9d6e44600b215154c3f66193df151f6}{serial\-Get} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Read a single byte. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga73d16b244172336e7306ea2e4cf90fa1}{serial\-Rx\-Buffer\-Full} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the receive buffer is full. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga742268372398b85935564fded999b198}{serial\-Rx\-Buffer\-Empty} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the receive buffer is empty. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_ga388583adaa7db4fad121b6454668b347}{serial\-Write} (uint8\-\_\-t uart, uint8\-\_\-t data)
\begin{DoxyCompactList}\small\item\em Send a byte. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}{serial\-Write\-String} (uint8\-\_\-t uart, const char $\ast$data)
\begin{DoxyCompactList}\small\item\em Send a string. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}{serial\-Tx\-Buffer\-Full} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the transmit buffer is full. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga14c345ea0707111e988a80ef1da65e32}{serial\-Tx\-Buffer\-Empty} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the transmit buffer is empty. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
U\-A\-R\-T Library enabling you to control all available U\-A\-R\-T Modules. With X\-O\-N/\-X\-O\-F\-F Flow Control and buffered Receiving and Transmitting. 

\subsection{Macro Definition Documentation}
\hypertarget{group__uart_gafccfd7d1315f0763ac404c6104883341}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!B\-A\-U\-D@{B\-A\-U\-D}}
\index{B\-A\-U\-D@{B\-A\-U\-D}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{B\-A\-U\-D}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-A\-U\-D(
\begin{DoxyParamCaption}
\item[{}]{baud\-Rate, }
\item[{}]{xtal\-Cpu}
\end{DoxyParamCaption}
)~((xtal\-Cpu)/((baud\-Rate)$\ast$16l)-\/1)}}\label{group__uart_gafccfd7d1315f0763ac404c6104883341}


Calculate Baudrate Register Value. 

\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{test_8c-example}{test.\-c}.\end{Desc}


Definition at line 45 of file serial.\-h.

\hypertarget{group__uart_gaff1f07741fbe1f53f46098687f0a05e2}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L@{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}}
\index{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L@{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}}\label{group__uart_gaff1f07741fbe1f53f46098687f0a05e2}


Defining this enables incoming X\-O\-N X\-O\-F\-F (sends X\-O\-F\-F if rx buff is full) 



Definition at line 62 of file serial.\-c.

\hypertarget{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!F\-L\-O\-W\-M\-A\-R\-K@{F\-L\-O\-W\-M\-A\-R\-K}}
\index{F\-L\-O\-W\-M\-A\-R\-K@{F\-L\-O\-W\-M\-A\-R\-K}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{F\-L\-O\-W\-M\-A\-R\-K}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-L\-O\-W\-M\-A\-R\-K~5}}\label{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}


Space remaining to trigger xoff/xon. 



Definition at line 64 of file serial.\-c.



Referenced by serial\-Get().

\hypertarget{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}}
\index{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E~32}}\label{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}


If you define this, a '\textbackslash{}r' (C\-R) will be put in front of a '\textbackslash{}n' (L\-F) when sending a byte. 

Binary Communication will then be impossible!\-R\-X Buffer Size in Bytes (Power of 2) 

Definition at line 54 of file serial.\-c.



Referenced by serial\-Get(), and serial\-Rx\-Buffer\-Full().

\hypertarget{group__uart_ga9ab33647617098646990fe263600b650}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}}
\index{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E~16}}\label{group__uart_ga9ab33647617098646990fe263600b650}


T\-X Buffer Size in Bytes (Power of 2) 



Definition at line 58 of file serial.\-c.



Referenced by serial\-Tx\-Buffer\-Full(), and serial\-Write().

\hypertarget{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!X\-O\-F\-F@{X\-O\-F\-F}}
\index{X\-O\-F\-F@{X\-O\-F\-F}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{X\-O\-F\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\-O\-F\-F~0x13}}\label{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}


X\-O\-F\-F Value. 



Definition at line 66 of file serial.\-c.



Referenced by set\-Flow().

\hypertarget{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!X\-O\-N@{X\-O\-N}}
\index{X\-O\-N@{X\-O\-N}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{X\-O\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\-O\-N~0x11}}\label{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}


X\-O\-N Value. 



Definition at line 65 of file serial.\-c.



Referenced by serial\-Get(), and set\-Flow().



\subsection{Function Documentation}
\hypertarget{group__uart_ga1ea963b291215ad9c5e8a0610f116b90}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Available@{serial\-Available}}
\index{serial\-Available@{serial\-Available}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Available}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Available (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{group__uart_ga1ea963b291215ad9c5e8a0610f116b90}


Get number of available U\-A\-R\-T modules. 

\begin{DoxyReturn}{Returns}
number of modules 
\end{DoxyReturn}
\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{test_8c-example}{test.\-c}.\end{Desc}


Definition at line 113 of file serial.\-c.


\begin{DoxyCode}
113                               \{
114     \textcolor{keywordflow}{return} UART\_COUNT;
115 \}
\end{DoxyCode}
\hypertarget{group__uart_gaa16a5ecaf9e40660ded50737ff1d0a88}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Close@{serial\-Close}}
\index{serial\-Close@{serial\-Close}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Close}]{\setlength{\rightskip}{0pt plus 5cm}void serial\-Close (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_gaa16a5ecaf9e40660ded50737ff1d0a88}


Stop the U\-A\-R\-T Hardware. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to stop \\
\hline
\end{DoxyParams}


Definition at line 148 of file serial.\-c.



References serial\-Tx\-Buffer\-Empty().


\begin{DoxyCode}
148                                \{
149     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
150         \textcolor{keywordflow}{return};
151 
152     uint8\_t sreg = SREG;
153     sei();
154     \textcolor{keywordflow}{while} (!\hyperlink{group__uart_ga14c345ea0707111e988a80ef1da65e32}{serialTxBufferEmpty}(uart));
155     \textcolor{keywordflow}{while} (*serialRegisters[uart][SERIALB] & (1 << serialBits[uart][SERIALUDRIE])); \textcolor{comment}{// Wait while Transmit
       Interrupt is on}
156     cli();
157     *serialRegisters[uart][SERIALB] = 0;
158     *serialRegisters[uart][SERIALC] = 0;
159     SREG = sreg;
160 \}
\end{DoxyCode}
\hypertarget{group__uart_gaa9d6e44600b215154c3f66193df151f6}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Get@{serial\-Get}}
\index{serial\-Get@{serial\-Get}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Get}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Get (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_gaa9d6e44600b215154c3f66193df151f6}


Read a single byte. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Received byte or 0 
\end{DoxyReturn}
\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{test_8c-example}{test.\-c}.\end{Desc}


Definition at line 217 of file serial.\-c.



References F\-L\-O\-W\-M\-A\-R\-K, R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E, and X\-O\-N.



Referenced by serial\-Get\-Blocking().


\begin{DoxyCode}
217                                 \{
218     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
219         \textcolor{keywordflow}{return} 0;
220 
221     uint8\_t c;
222 
223 \textcolor{preprocessor}{#ifdef FLOWCONTROL}
224 \textcolor{preprocessor}{}    rxBufferElements[uart]--;
225     \textcolor{keywordflow}{if} ((flow[uart] == 0) && (rxBufferElements[uart] <= \hyperlink{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}{FLOWMARK})) \{
226         \textcolor{keywordflow}{while} (sendThisNext[uart] != 0);
227         sendThisNext[uart] = \hyperlink{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{XON};
228         flow[uart] = 1;
229         \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
230             shouldStartTransmission[uart] = 0;
231             *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]); \textcolor{comment}{// Enable Interrupt}
232             *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger Interrupt}
233         \}
234     \}
235 \textcolor{preprocessor}{#endif}
236 \textcolor{preprocessor}{}
237     \textcolor{keywordflow}{if} (rxRead[uart] != rxWrite[uart]) \{
238         c = rxBuffer[uart][rxRead[uart]];
239         rxBuffer[uart][rxRead[uart]] = 0;
240         \textcolor{keywordflow}{if} (rxRead[uart] < (\hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{RX\_BUFFER\_SIZE} - 1)) \{
241             rxRead[uart]++;
242         \} \textcolor{keywordflow}{else} \{
243             rxRead[uart] = 0;
244         \}
245         \textcolor{keywordflow}{return} c;
246     \} \textcolor{keywordflow}{else} \{
247         \textcolor{keywordflow}{return} 0;
248     \}
249 \}
\end{DoxyCode}
\hypertarget{group__uart_gaf7c4238a9a5e8fff64af1faf1689a5a4}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Get\-Blocking@{serial\-Get\-Blocking}}
\index{serial\-Get\-Blocking@{serial\-Get\-Blocking}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Get\-Blocking}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Get\-Blocking (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_gaf7c4238a9a5e8fff64af1faf1689a5a4}


Wait until a character is received. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Received byte 
\end{DoxyReturn}


Definition at line 209 of file serial.\-c.



References serial\-Get(), and serial\-Has\-Char().


\begin{DoxyCode}
209                                         \{
210     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
211         \textcolor{keywordflow}{return} 0;
212 
213     \textcolor{keywordflow}{while}(!\hyperlink{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}{serialHasChar}(uart));
214     \textcolor{keywordflow}{return} \hyperlink{group__uart_gaa9d6e44600b215154c3f66193df151f6}{serialGet}(uart);
215 \}
\end{DoxyCode}
\hypertarget{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Has\-Char@{serial\-Has\-Char}}
\index{serial\-Has\-Char@{serial\-Has\-Char}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Has\-Char}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Has\-Char (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}


Check if a byte was received. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if a byte was received, 0 if not 
\end{DoxyReturn}
\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{test_8c-example}{test.\-c}.\end{Desc}


Definition at line 198 of file serial.\-c.



Referenced by serial\-Get\-Blocking().


\begin{DoxyCode}
198                                     \{
199     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
200         \textcolor{keywordflow}{return} 0;
201 
202     \textcolor{keywordflow}{if} (rxRead[uart] != rxWrite[uart]) \{ \textcolor{comment}{// True if char available}
203         \textcolor{keywordflow}{return} 1;
204     \} \textcolor{keywordflow}{else} \{
205         \textcolor{keywordflow}{return} 0;
206     \}
207 \}
\end{DoxyCode}
\hypertarget{group__uart_ga73d4335cb201753c580c87954f493886}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Init@{serial\-Init}}
\index{serial\-Init@{serial\-Init}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Init}]{\setlength{\rightskip}{0pt plus 5cm}void serial\-Init (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{uint16\-\_\-t}]{baud}
\end{DoxyParamCaption}
)}}\label{group__uart_ga73d4335cb201753c580c87954f493886}


Initialize the U\-A\-R\-T Hardware. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to initialize \\
\hline
{\em baud} & Baudrate. Use the \hyperlink{group__uart_gafccfd7d1315f0763ac404c6104883341}{B\-A\-U\-D()} macro! \\
\hline
\end{DoxyParams}
\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{test_8c-example}{test.\-c}.\end{Desc}


Definition at line 117 of file serial.\-c.


\begin{DoxyCode}
117                                              \{
118     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
119         \textcolor{keywordflow}{return};
120 
121     \textcolor{comment}{// Initialize state variables}
122     rxRead[uart] = 0;
123     rxWrite[uart] = 0;
124     txRead[uart] = 0;
125     txWrite[uart] = 0;
126     shouldStartTransmission[uart] = 1;
127 \textcolor{preprocessor}{#ifdef FLOWCONTROL}
128 \textcolor{preprocessor}{}    sendThisNext[uart] = 0;
129     flow[uart] = 1;
130     rxBufferElements[uart] = 0;
131 \textcolor{preprocessor}{#endif}
132 \textcolor{preprocessor}{}
133     \textcolor{comment}{// Default Configuration: 8N1}
134     *serialRegisters[uart][SERIALC] = (1 << serialBits[uart][SERIALUCSZ0]) | (1 << serialBits[uart][
      SERIALUCSZ1]);
135 
136     \textcolor{comment}{// Set baudrate}
137 \textcolor{preprocessor}{#if SERIALBAUDBIT == 8}
138 \textcolor{preprocessor}{}    *serialRegisters[uart][SERIALUBRRH] = (baud >> 8);
139     *serialRegisters[uart][SERIALUBRRL] = baud;
140 \textcolor{preprocessor}{#else}
141 \textcolor{preprocessor}{}    *serialBaudRegisters[uart] = baud;
142 \textcolor{preprocessor}{#endif}
143 \textcolor{preprocessor}{}
144     *serialRegisters[uart][SERIALB] = (1 << serialBits[uart][SERIALRXCIE]); \textcolor{comment}{// Enable Interrupts}
145     *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALRXEN]) | (1 << serialBits[uart][
      SERIALTXEN]); \textcolor{comment}{// Enable Receiver/Transmitter}
146 \}
\end{DoxyCode}
\hypertarget{group__uart_ga742268372398b85935564fded999b198}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Rx\-Buffer\-Empty@{serial\-Rx\-Buffer\-Empty}}
\index{serial\-Rx\-Buffer\-Empty@{serial\-Rx\-Buffer\-Empty}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Rx\-Buffer\-Empty}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Rx\-Buffer\-Empty (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga742268372398b85935564fded999b198}


Check if the receive buffer is empty. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is empty, 0 if not. 
\end{DoxyReturn}


Definition at line 258 of file serial.\-c.


\begin{DoxyCode}
258                                           \{
259     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
260         \textcolor{keywordflow}{return} 0;
261 
262     \textcolor{keywordflow}{if} (rxRead[uart] != rxWrite[uart]) \{
263         \textcolor{keywordflow}{return} 0;
264     \} \textcolor{keywordflow}{else} \{
265         \textcolor{keywordflow}{return} 1;
266     \}
267 \}
\end{DoxyCode}
\hypertarget{group__uart_ga73d16b244172336e7306ea2e4cf90fa1}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Rx\-Buffer\-Full@{serial\-Rx\-Buffer\-Full}}
\index{serial\-Rx\-Buffer\-Full@{serial\-Rx\-Buffer\-Full}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Rx\-Buffer\-Full}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Rx\-Buffer\-Full (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga73d16b244172336e7306ea2e4cf90fa1}


Check if the receive buffer is full. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is full, 0 if not 
\end{DoxyReturn}


Definition at line 251 of file serial.\-c.



References R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E.


\begin{DoxyCode}
251                                          \{
252     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
253         \textcolor{keywordflow}{return} 0;
254 
255     \textcolor{keywordflow}{return} (((rxWrite[uart] + 1) == rxRead[uart]) || ((rxRead[uart] == 0) && ((rxWrite[uart] + 1) == 
      \hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{RX\_BUFFER\_SIZE})));
256 \}
\end{DoxyCode}
\hypertarget{group__uart_ga14c345ea0707111e988a80ef1da65e32}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Tx\-Buffer\-Empty@{serial\-Tx\-Buffer\-Empty}}
\index{serial\-Tx\-Buffer\-Empty@{serial\-Tx\-Buffer\-Empty}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Tx\-Buffer\-Empty}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Tx\-Buffer\-Empty (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga14c345ea0707111e988a80ef1da65e32}


Check if the transmit buffer is empty. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is empty, 0 if not. 
\end{DoxyReturn}


Definition at line 317 of file serial.\-c.



Referenced by serial\-Close().


\begin{DoxyCode}
317                                           \{
318     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
319         \textcolor{keywordflow}{return} 0;
320 
321     \textcolor{keywordflow}{if} (txRead[uart] != txWrite[uart]) \{
322         \textcolor{keywordflow}{return} 0;
323     \} \textcolor{keywordflow}{else} \{
324         \textcolor{keywordflow}{return} 1;
325     \}
326 \}
\end{DoxyCode}
\hypertarget{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Tx\-Buffer\-Full@{serial\-Tx\-Buffer\-Full}}
\index{serial\-Tx\-Buffer\-Full@{serial\-Tx\-Buffer\-Full}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Tx\-Buffer\-Full}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Tx\-Buffer\-Full (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}


Check if the transmit buffer is full. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is full, 0 if not 
\end{DoxyReturn}


Definition at line 310 of file serial.\-c.



References T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E.



Referenced by serial\-Write().


\begin{DoxyCode}
310                                          \{
311     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
312         \textcolor{keywordflow}{return} 0;
313 
314     \textcolor{keywordflow}{return} (((txWrite[uart] + 1) == txRead[uart]) || ((txRead[uart] == 0) && ((txWrite[uart] + 1) == 
      \hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{TX\_BUFFER\_SIZE})));
315 \}
\end{DoxyCode}
\hypertarget{group__uart_ga388583adaa7db4fad121b6454668b347}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Write@{serial\-Write}}
\index{serial\-Write@{serial\-Write}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Write}]{\setlength{\rightskip}{0pt plus 5cm}void serial\-Write (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{uint8\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{group__uart_ga388583adaa7db4fad121b6454668b347}


Send a byte. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to write to \\
\hline
{\em data} & Byte to send \\
\hline
\end{DoxyParams}
\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{test_8c-example}{test.\-c}.\end{Desc}


Definition at line 273 of file serial.\-c.



References serial\-Tx\-Buffer\-Full(), and T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E.



Referenced by serial\-Write\-String().


\begin{DoxyCode}
273                                              \{
274     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
275         \textcolor{keywordflow}{return};
276 
277 \textcolor{preprocessor}{#ifdef SERIALINJECTCR}
278 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (data == \textcolor{charliteral}{'\(\backslash\)n'}) \{
279         \hyperlink{group__uart_ga388583adaa7db4fad121b6454668b347}{serialWrite}(uart, \textcolor{charliteral}{'\(\backslash\)r'});
280     \}
281 \textcolor{preprocessor}{#endif}
282 \textcolor{preprocessor}{}    \textcolor{keywordflow}{while} (\hyperlink{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}{serialTxBufferFull}(uart));
283 
284     txBuffer[uart][txWrite[uart]] = data;
285     \textcolor{keywordflow}{if} (txWrite[uart] < (\hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{TX\_BUFFER\_SIZE} - 1)) \{
286         txWrite[uart]++;
287     \} \textcolor{keywordflow}{else} \{
288         txWrite[uart] = 0;
289     \}
290     \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
291         shouldStartTransmission[uart] = 0;
292         *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]); \textcolor{comment}{// Enable Interrupt}
293         *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger Interrupt}
294     \}
295 \}
\end{DoxyCode}
\hypertarget{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Write\-String@{serial\-Write\-String}}
\index{serial\-Write\-String@{serial\-Write\-String}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Write\-String}]{\setlength{\rightskip}{0pt plus 5cm}void serial\-Write\-String (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{const char $\ast$}]{data}
\end{DoxyParamCaption}
)}}\label{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}


Send a string. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to write to \\
\hline
{\em data} & Null-\/\-Terminated String \\
\hline
\end{DoxyParams}
\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{test_8c-example}{test.\-c}.\end{Desc}


Definition at line 297 of file serial.\-c.



References serial\-Write().


\begin{DoxyCode}
297                                                        \{
298     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
299         \textcolor{keywordflow}{return};
300 
301     \textcolor{keywordflow}{if} (data == 0) \{
302         \hyperlink{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}{serialWriteString}(uart, \textcolor{stringliteral}{"NULL"});
303     \} \textcolor{keywordflow}{else} \{
304         \textcolor{keywordflow}{while} (*data != \textcolor{charliteral}{'\(\backslash\)0'}) \{
305             \hyperlink{group__uart_ga388583adaa7db4fad121b6454668b347}{serialWrite}(uart, *data++);
306         \}
307     \}
308 \}
\end{DoxyCode}
\hypertarget{group__uart_ga5d5de9e3ed5a0be11f707113cfff33f5}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!set\-Flow@{set\-Flow}}
\index{set\-Flow@{set\-Flow}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{set\-Flow}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Flow (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{uint8\-\_\-t}]{on}
\end{DoxyParamCaption}
)}}\label{group__uart_ga5d5de9e3ed5a0be11f707113cfff33f5}


Manually change the flow control. 

Flow Control has to be compiled into the library! 
\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to operate on \\
\hline
{\em on} & 1 of on, 0 if off \\
\hline
\end{DoxyParams}


Definition at line 163 of file serial.\-c.



References X\-O\-F\-F, and X\-O\-N.


\begin{DoxyCode}
163                                        \{
164     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
165         \textcolor{keywordflow}{return};
166 
167     \textcolor{keywordflow}{if} (flow[uart] != on) \{
168         \textcolor{keywordflow}{if} (on == 1) \{
169             \textcolor{comment}{// Send XON}
170             \textcolor{keywordflow}{while} (sendThisNext[uart] != 0);
171             sendThisNext[uart] = \hyperlink{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{XON};
172             flow[uart] = 1;
173             \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
174                 shouldStartTransmission[uart] = 0;
175                 *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]);
176                 *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger
       Interrupt}
177             \}
178         \} \textcolor{keywordflow}{else} \{
179             \textcolor{comment}{// Send XOFF}
180             sendThisNext[uart] = \hyperlink{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}{XOFF};
181             flow[uart] = 0;
182             \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
183                 shouldStartTransmission[uart] = 0;
184                 *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]);
185                 *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger
       Interrupt}
186             \}
187         \}
188         \textcolor{comment}{// Wait till it's transmitted}
189         \textcolor{keywordflow}{while} (*serialRegisters[uart][SERIALB] & (1 << serialBits[uart][SERIALUDRIE]));
190     \}
191 \}
\end{DoxyCode}
